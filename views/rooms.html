<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Join Room</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
    :root{--lav:#F4E9FF; --purple:#6F2DBD; --purple2:#8E44AD;}
    body{background: var(--lav);}
    .card{border:0; border-radius:18px; box-shadow:0 10px 30px rgba(111,45,189,.15);}
    .btn-purple{background:var(--purple); border:0;}
    .btn-purple:hover{background:var(--purple2);}
    .soft-input{border-radius:14px; border:1px solid rgba(111,45,189,.25);}
    .soft-input:focus{border-color:var(--purple); box-shadow:0 0 0 .2rem rgba(111,45,189,.15);}
    .brand{color:var(--purple); font-weight:800;}
  </style>
</head>
<body>
    
    <div class="container mt-4" style="max-width:720px;">
    <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="brand" style="font-size:24px;">Chat Server</div>
    <button id="logout" class="btn btn-outline-danger btn-sm">Logout</button>
    </div>
    
    <div class="card p-4">
    <label class="form-label" style="color:var(--purple); font-weight:600;">Logged in as</label>
    <input id="me" class="form-control soft-input mb-3" disabled>

    <label class="form-label" style="color:var(--purple); font-weight:600;">Choose Room</label>
    <select id="room" class="form-select soft-input mb-3"></select>

    <button id="join" class="btn btn-purple text-white w-100">Join Room</button>
  </div>
</div>

<script>
const token = localStorage.getItem("token");
const username = localStorage.getItem("username");
if (!token || !username) window.location.href = "/views/login.html";
me.value = username;

(async () => {
    const res = await fetch("/api/rooms");
    const rooms = await res.json();
    rooms.forEach(r => room.innerHTML += `<option value="${r}">${r}</option>`);
})();

join.onclick = () => {
    localStorage.setItem("room", room.value);
    window.location.href = "/views/chat.html";
};

logout.onclick = () => {
    localStorage.clear();
    window.location.href = "/views/login.html";
};
</script>
</body>
</html>